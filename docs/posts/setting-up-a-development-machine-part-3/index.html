<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Many nights of potential productive work programmers have lost by procrastinating on properly managing their dotfiles. This article discusses an elegant way to manage and share dotfiles across machines using a single git repository.
">
<title>Dotfiles Management &#183; Kalkayan Engineering</title>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=/css/fonts.css>
<link rel=stylesheet href=/custom.css>
<link rel=icon href=favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png>
<link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png>
<link href rel=alternate type=application/rss+xml title="Kalkayan Engineering">
</head>
<body>
<nav class=nav>
<div class=nav-container>
<a href=/>
<img class=logo src=/logo-eng.png alt>
</a>
<ul>
<li>
<a href=/about/>
<span>About</span>
</a>
</li>
<li>
<a href=/categories/>
<span>Categories</span>
</a>
</li>
<li>
<a href=/posts/>
<span>Posts</span>
</a>
</li>
</ul>
</div>
</nav>
<main>
<div class=post>
<div class=post-info>
<span>Written by</span>
Manish Sahani
</div>
<h1 class=post-title>Dotfiles Management</h1>
<div class=post-line></div>
<p><img src=images/banner.jpg alt=banner></p>
<p>Customizing an operating system has always fascinated programmers. There are tons of great articles out there with great customization tips. Most of these articles use dotfiles for customization, and these simple invisible files may seem pointless for a novice. But, they become a swiss army knife if properly configured.</p>
<p>Personalizing a system takes a lot of time and hard work, and nobody wishes to do it over and over again. Setting up a machine with a preferred setting should be done in minimal steps and without writing any code. I&rsquo;ve divided this process into two parts: sharing dotfiles and writing an automated script.</p>
<p>This article will discuss an elegant way to manage, modify, and share dotfiles across multiple devices using a single <code>git</code> repository.</p>
<h1 id=managing-and-tracking-dotfiles>Managing and tracking [dot]files</h1>
<p>The majority of developers use <code>git</code> to manage and share these files and use <code>symlinks</code> to sync them. Well, <code>symlinks</code> works, but it isn&rsquo;t the best way to sync your local files to the git repository. There are a good number of issues on <a href=https://stackoverflow.com/questions/46534290/symlink-dotfiles/64548852#64548852>StackOverflow</a>, pointing issues with dotfiles and symlinks. There is a much better solution to this, written by people at Atlassian &ndash; <a href=https://www.atlassian.com/git/tutorials/dotfiles>The best way to store your dotfiles: A bare Git repository </a>.</p>
<p>The trick to managing these dotfiles is by creating a <a href=https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-init>bare</a> git repository. If you start from scratch, make a <code>bare</code> repository in the <code>$HOME</code> directory.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># notice the --bare flag; this initializes the repository as a git bare</span>
git init --bare $HOME/.dotfiles
</code></pre></div><p>Bare repositories are special in a way that they omit the working directory. Therefore, we need to define a work tree and git directory for the repository. The <code>--work-tree</code> is set to $HOME directory (since dotfiles live there) and <code>--git-dir</code> to <code>$HOME/.dotfiles</code>(this is our repository location). Our command to use the repository has the prefix<code>git --work-dir $HOME --git-dir $HOME/.dotfiles</code></p>
<p>To make it easier to use, we alias this to <code>dotfiles</code>, which we will use to interact with our dotfiles repository.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>alias dotfiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/git --git-dir=</span>$HOME<span style=color:#e6db74>/.dotfiles --work-tree=</span>$HOME<span style=color:#e6db74>&#34;</span>
</code></pre></div><p><strong>Thats it!</strong> We are good to track our dotfiles using the dotfiles command. Some of the examples are:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># to check the version history</span>
dotfiles log

<span style=color:#75715e># to check the status of the tracked and untracked files</span>
dotfiles status

<span style=color:#75715e># to add a file for tracking</span>
dotfiles commit .vimrc -m <span style=color:#e6db74>&#34;.vimrc added&#34;</span>

<span style=color:#75715e># push new files or changes to the github</span>
dotfiles push origin main
</code></pre></div><p>If we look at the output of <code>dotfiles status</code>, We can see all files under <code>$HOME</code> directory are coming under untracked files (see the left side of screenshot below). We clearly don&rsquo;t want this behavior, and to fix this behavior, we modify the dotfiles repository status configs like below:</p>
<pre tabindex=0><code># hides all the untracked files when status command is called
dotfiles config status.showUntrackedFiles no
</code></pre>
<h1 id=advantages-and-use-cases>Advantages and Use Cases</h1>
<p>Besides easier management and sharing, this method has various other advantages like:</p>
<h3 id=easy-setup>Easy setup</h3>
<p>Setting up a new machine can be a time-consuming task, But with this method, we can use our personalized configs in under a minute.
We just need to clone the repository and source the <code>.bashrc</code> or <code>.zshrc</code> file.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone --bare https://github.com/&lt;username&gt;/dotfiles.git $HOME/.dotfiles <span style=color:#f92672>&amp;&amp;</span> source ~/.zshrc
</code></pre></div><h3 id=versioned-dotfiles>Versioned dotfiles</h3>
<p>Best for experimenting with new configurations and keep the change history (Basically all the pros of using git)</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># to check the version history</span>
dotfiles log
</code></pre></div><h3 id=share-on-multiple-devices>Share on Multiple devices</h3>
<p>Share the same configs of multiple devices with minimal changes using <strong>git branches</strong>. Create a branch for your new machine, example:-</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Create configurations specific to your aws machines</span>
dotfiles checkout -b aws
</code></pre></div><h3 id=profiles-for-dotfiles>Profiles for dotfiles</h3>
<p>Create configs based on your environment using <code>branch</code>, create a branch and configure according to you work env.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Manage multiple profiles - check out to the work profile</span>
dotfiles checkout work
</code></pre></div><h1 id=heading></h1>
<p>We completed the first part of our tooling setup, next read - <a href=/posts/automated-setup/>Automate the setup of your development machine</a>.</p>
</div>
<div class=pagination>
<a href=/posts/setting-up-a-development-machine-part-1/ class="right arrow">&#8594;</a>
<a href=# class=top>Top</a>
</div>
</main>
<footer>
<span>
&copy; <time datetime="2021-10-20 17:35:03.392369 +0530 IST m=+0.159370967">2021</time> . Made with <a href=https://gohugo.io>Hugo</a> using the <a href=https://github.com/EmielH/tale-hugo/>Tale</a> theme.
</span>
</footer>
</body>
</html>
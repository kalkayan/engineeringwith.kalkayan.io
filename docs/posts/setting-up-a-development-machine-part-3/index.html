<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Kalkayan Engineering</title><link rel=stylesheet href=https://engineering.kalkayan.io/scss/main.min.9db8651f3f7598964314c80e4e9cae9a65a2025ca2634d756b2a8054a276b2f6.css><script src=https://engineering.kalkayan.io/js/bootstrap.min.js></script></head><body id=top><nav class="navbar navbar-expand-lg navbar-light fixed-top pt-3 pb-3"><div class=container><a class="nav-link pl-0 text-muted" href=#>Engineering</a><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class=navbar-nav style=margin-left:auto><li class="nav-item active"><a class=nav-link href=#>Home</a></li><li class=nav-item><a class=nav-link href=https://github.com/kalkayan/dotfiles>github</a></li></ul></div></div></nav><main class=main><article><div class=banner><div class=container><div class=col-md-8><h1 class=title>Setting up a Development Machine [Part 3]: Dotfiles management</h1></div><p>By Manish Sahani on Monday, 15 July 2019</p></div></div><div class=post><div class=container><div class=description>Many nights of potential productive work programmers have lost by procrastinating on properly managing their dotfiles. This article discusses an elegant way to manage and share dotfiles across machines using a single git repository.</div><div class=content><p><img src=images/banner.jpg alt=banner></p><p>Customizing an operating system has always fascinated programmers. There are tons of great articles out there with great customization tips. Most of these articles use dotfiles for customization, and these simple invisible files may seem pointless for a novice. But, they become a swiss army knife if properly configured.</p><p>Personalizing a system takes a lot of time and hard work, and nobody wishes to do it over and over again. Setting up a machine with a preferred setting should be done in minimal steps and without writing any code. I&rsquo;ve divided this process into two parts: sharing dotfiles and writing an automated script.</p><p>This article will discuss an elegant way to manage, modify, and share dotfiles across multiple devices using a single <code>git</code> repository.</p><h1 id=managing-and-tracking-dotfiles>Managing and tracking [dot]files<a hidden class=anchor aria-hidden=true href=#managing-and-tracking-dotfiles>#</a></h1><p>The majority of developers use <code>git</code> to manage and share these files and use <code>symlinks</code> to sync them. Well, <code>symlinks</code> works, but it isn&rsquo;t the best way to sync your local files to the git repository. There are a good number of issues on <a href=https://stackoverflow.com/questions/46534290/symlink-dotfiles/64548852#64548852>StackOverflow</a>, pointing issues with dotfiles and symlinks. There is a much better solution to this, written by people at Atlassian &ndash; <a href=https://www.atlassian.com/git/tutorials/dotfiles>The best way to store your dotfiles: A bare Git repository </a>.</p><p>The trick to managing these dotfiles is by creating a <a href=https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-init>bare</a> git repository. If you start from scratch, make a <code>bare</code> repository in the <code>$HOME</code> directory.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># notice the --bare flag; this initializes the repository as a git bare</span>
git init --bare $HOME/.dotfiles
</code></pre></div><p>Bare repositories are special in a way that they omit the working directory. Therefore, we need to define a work tree and git directory for the repository. The <code>--work-tree</code> is set to $HOME directory (since dotfiles live there) and <code>--git-dir</code> to <code>$HOME/.dotfiles</code> (this is our repository location). Our command to use the repository has the prefix <code>git --work-dir $HOME --git-dir $HOME/.dotfiles</code></p><p>To make it easier to use, we alias this to <code>dotfiles</code>, which we will use to interact with our dotfiles repository.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>alias dotfiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/git --git-dir=</span>$HOME<span style=color:#e6db74>/.dotfiles --work-tree=</span>$HOME<span style=color:#e6db74>&#34;</span>
</code></pre></div><p><strong>Thats it!</strong> We are good to track our dotfiles using the dotfiles command. Some of the examples are:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># to check the version history </span>
dotfiles log

<span style=color:#75715e># to check the status of the tracked and untracked files </span>
dotfiles status

<span style=color:#75715e># to add a file for tracking</span>
dotfiles commit .vimrc -m <span style=color:#e6db74>&#34;.vimrc added&#34;</span>

<span style=color:#75715e># push new files or changes to the github</span>
dotfiles push origin main
</code></pre></div><p>If we look at the output of <code>dotfiles status</code>, We can see all files under <code>$HOME</code> directory are coming under untracked files (see the left side of screenshot below). We clearly don&rsquo;t want this behavior, and to fix this behavior, we modify the dotfiles repository status configs like below:</p><pre><code># hides all the untracked files when status command is called
dotfiles config status.showUntrackedFiles no
</code></pre><h1 id=advantages-and-use-cases>Advantages and Use Cases<a hidden class=anchor aria-hidden=true href=#advantages-and-use-cases>#</a></h1><p>Besides easier management and sharing, this method has various other advantages like:</p><h3 id=easy-setup>Easy setup<a hidden class=anchor aria-hidden=true href=#easy-setup>#</a></h3><p>Setting up a new machine can be a time-consuming task, But with this method, we can use our personalized configs in under a minute.
We just need to clone the repository and source the <code>.bashrc</code> or <code>.zshrc</code> file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone --bare https://github.com/&lt;username&gt;/dotfiles.git $HOME/.dotfiles <span style=color:#f92672>&amp;&amp;</span> source ~/.zshrc
</code></pre></div><h3 id=versioned-dotfiles>Versioned dotfiles<a hidden class=anchor aria-hidden=true href=#versioned-dotfiles>#</a></h3><p>Best for experimenting with new configurations and keep the change history (Basically all the pros of using git)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># to check the version history </span>
dotfiles log
</code></pre></div><h3 id=share-on-multiple-devices>Share on Multiple devices<a hidden class=anchor aria-hidden=true href=#share-on-multiple-devices>#</a></h3><p>Share the same configs of multiple devices with minimal changes using <strong>git branches</strong>. Create a branch for your new machine, example:-</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Create configurations specific to your aws machines</span>
dotfiles checkout -b aws
</code></pre></div><h3 id=profiles-for-dotfiles>Profiles for dotfiles<a hidden class=anchor aria-hidden=true href=#profiles-for-dotfiles>#</a></h3><p>Create configs based on your environment using <code>branch</code>, create a branch and configure according to you work env.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Manage multiple profiles - check out to the work profile </span>
dotfiles checkout work
</code></pre></div><h1 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h1><p>We completed the first part of our tooling setup, next read - <a href=/posts/automated-setup/>Automate the setup of your development machine</a>.</p></div></div></div></article><footer class=footer><span>&copy; 2021 <a href=https://engineering.kalkayan.io>Kalkayan Engineering</a></span>
<span>&#183;</span><br><span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>Kalkayan.eng</a></span></footer><script>let scrollpos=window.scrollY;const header=document.querySelector("nav"),add_class_on_scroll=a=>header.classList.add(a),remove_class_on_scroll=a=>header.classList.remove(a);window.addEventListener('scroll',function(){scrollpos=window.scrollY,scrollpos>='400'?(add_class_on_scroll("bg-white"),add_class_on_scroll("shadow-sm")):(remove_class_on_scroll("bg-white"),remove_class_on_scroll("shadow-sm"))})</script></main></body></html>